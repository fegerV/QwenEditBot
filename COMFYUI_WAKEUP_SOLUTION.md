# üîß –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã "–∑–∞—Å—ã–ø–∞–Ω–∏—è" ComfyUI

## üìã –ü—Ä–æ–±–ª–µ–º–∞

ComfyUI –∏–Ω–æ–≥–¥–∞ "–∑–∞—Å—ã–ø–∞–µ—Ç" –≤ –æ–∫–Ω–µ –∫–æ–Ω—Å–æ–ª–∏ Windows - –ø—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –Ω–æ –≤—ã–≤–æ–¥ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è. –ü—Ä–∏ –∫–ª–∏–∫–µ –ø–æ –æ–∫–Ω—É –ø—Ä–æ—Ü–µ—Å—Å "–ø—Ä–æ—Å—ã–ø–∞–µ—Ç—Å—è" –∏ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É.

**–ü—Ä–∏—á–∏–Ω—ã:**
- –ë—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—è –≤—ã–≤–æ–¥–∞ –≤ Windows –∫–æ–Ω—Å–æ–ª–∏
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –æ–∫–Ω–µ
- –ü—Ä–æ–±–ª–µ–º—ã —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π —Å–æ–±—ã—Ç–∏–π –æ–∫–Ω–∞

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### –†–µ—à–µ–Ω–∏–µ 1: ComfyUI Watchdog (API-based) ‚≠ê –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø

**–§–∞–π–ª:** `comfyui_watchdog.py`

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã –∫ ComfyUI API
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∑–¥–æ—Ä–æ–≤—å–µ —á–µ—Ä–µ–∑ `/system_stats`
- –ï—Å–ª–∏ –Ω–µ—Ç –æ—Ç–≤–µ—Ç–∞ - –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç "–ø—Ä–æ–±—É–∂–¥–∞—é—â–∏–µ" –∑–∞–ø—Ä–æ—Å—ã

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–∫–Ω—É
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ –æ–∫–Ω–æ —Å–≤–µ—Ä–Ω—É—Ç–æ
- ‚úÖ –õ–µ–≥–∫–∏–π –∏ –Ω–∞–¥–µ–∂–Ω—ã–π
- ‚úÖ –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python comfyui_watchdog.py
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏: 10 —Å–µ–∫—É–Ω–¥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- URL ComfyUI: `http://localhost:8188` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –õ–æ–≥–∏: `logs/comfyui_watchdog.log`

---

### –†–µ—à–µ–Ω–∏–µ 2: ComfyUI Window Waker (Windows API)

**–§–∞–π–ª:** `comfyui_window_waker.py`

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ù–∞—Ö–æ–¥–∏—Ç –æ–∫–Ω–æ ComfyUI –ø–æ –∑–∞–≥–æ–ª–æ–≤–∫—É
- –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–±—ã—Ç–∏—è –≤ –æ–∫–Ω–æ (–∫–∞–∫ –∫–ª–∏–∫ –º—ã—à–∏)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Windows API –¥–ª—è "–ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è"

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü—Ä—è–º–æ–µ –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ –æ–∫–Ω–æ
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –û–°
- ‚úÖ –ë–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –¥–ª—è –∫–æ–Ω—Å–æ–ª—å–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –æ–∫–Ω–æ –±—ã–ª–æ –≤–∏–¥–∏–º—ã–º
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞—Ç—å —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
python comfyui_window_waker.py
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- –ò–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è: 30 —Å–µ–∫—É–Ω–¥ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –ù–∞–∑–≤–∞–Ω–∏–µ –æ–∫–Ω–∞: "ComfyUI" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- –õ–æ–≥–∏: `logs/comfyui_waker.log`

---

## üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫

–û–±–∞ —Ä–µ—à–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `start_for_telegram_processing.bat`:

```batch
:: Start ComfyUI Watchdog
start "ComfyUI Watchdog" cmd /c "python comfyui_watchdog.py"
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Ç–æ–ª—å–∫–æ Watchdog** (–†–µ—à–µ–Ω–∏–µ 1), —Ç–∞–∫ –∫–∞–∫ –æ–Ω–æ –±–æ–ª–µ–µ –Ω–∞–¥–µ–∂–Ω–æ–µ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–∫–Ω—É.

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏ Watchdog:
```
logs/comfyui_watchdog.log
```

**–ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:**
```
2026-01-24 23:45:00 - INFO - ComfyUI health check OK (150/150)
2026-01-24 23:45:10 - INFO - ComfyUI health check OK (151/151)
2026-01-24 23:45:20 - WARNING - ComfyUI health check FAILED (1/152)
2026-01-24 23:45:20 - INFO - Attempting to wake up ComfyUI...
2026-01-24 23:45:21 - INFO - ComfyUI wakeup sequence completed
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
Watchdog –≤—ã–≤–æ–¥–∏—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ:
```
ComfyUI Watchdog Statistics:
  Total checks: 1000
  Successful: 995
  Failed: 5
  Wakeup calls: 5
  Success rate: 99.5%
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤

### –î–ª—è Watchdog (API-based):
```python
# –í comfyui_watchdog.py
interval = 10.0  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- **10-15 —Å–µ–∫—É–Ω–¥** - –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã
- **30 —Å–µ–∫—É–Ω–¥** - –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ —Ä–µ—Å—É—Ä—Å–æ–≤
- **5 —Å–µ–∫—É–Ω–¥** - –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –∑–∞–¥–∞—á

### –î–ª—è Window Waker:
```python
# –í comfyui_window_waker.py
interval = 30.0  # –ü—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
- **30 —Å–µ–∫—É–Ω–¥** - –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ
- **60 —Å–µ–∫—É–Ω–¥** - –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏
- **15 —Å–µ–∫—É–Ω–¥** - –¥–ª—è —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–π

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã Watchdog:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å:**
```powershell
Get-Process python | Where-Object {$_.MainWindowTitle -like "*Watchdog*"}
```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
```powershell
Get-Content logs/comfyui_watchdog.log -Tail 50
```

3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É:**
   - –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø—Ä–∏ –æ—Å—Ç–∞–Ω–æ–≤–∫–µ
   - –ò–ª–∏ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π –≤—ã–≤–æ–¥

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã Window Waker:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–æ—Ü–µ—Å—Å:**
```powershell
Get-Process python | Where-Object {$_.MainWindowTitle -like "*Waker*"}
```

2. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏:**
```powershell
Get-Content logs/comfyui_waker.log -Tail 50
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:
1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **—Ç–æ–ª—å–∫–æ Watchdog** (–†–µ—à–µ–Ω–∏–µ 1)
2. ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª **10-15 —Å–µ–∫—É–Ω–¥**
3. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –ø—Ä–æ–±–ª–µ–º
4. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ —á–∞—Å—Ç—ã—Ö —Å–±–æ—è—Ö

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±–∞ —Ä–µ—à–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
2. Window Waker –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
3. Watchdog –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω –≤—Å–µ–≥–¥–∞

---

## üêõ Troubleshooting

### Watchdog –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ Python —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ª–æ–≥–∞–º
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ ComfyUI –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ URL

### Window Waker –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –æ–∫–Ω–æ:
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–∫–Ω–æ ComfyUI –æ—Ç–∫—Ä—ã—Ç–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ—á–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –æ–∫–Ω–∞ –≤ –ª–æ–≥–∞—Ö
- –ò–∑–º–µ–Ω–∏—Ç–µ `window_title` –≤ –∫–æ–¥–µ

### ComfyUI –≤—Å–µ –µ—â–µ "–∑–∞—Å—ã–ø–∞–µ—Ç":
- –£–º–µ–Ω—å—à–∏—Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±–∞ —Ä–µ—à–µ–Ω–∏—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
- –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ unbuffered Python –¥–ª—è ComfyUI

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

### –î–ª—è ComfyUI –∑–∞–ø—É—Å–∫–∞:

–ú–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å ComfyUI —Å unbuffered output:
```batch
python -u ComfyUI\main.py --windows-standalone-build
```

–ò–ª–∏ —á–µ—Ä–µ–∑ PowerShell:
```powershell
$env:PYTHONUNBUFFERED=1
python ComfyUI\main.py --windows-standalone-build
```

–≠—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—Ç–∏—Ç –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏—é –≤—ã–≤–æ–¥–∞ –∏ –º–æ–∂–µ—Ç —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –Ω–∞ –∫–æ—Ä–Ω–µ–≤–æ–º —É—Ä–æ–≤–Ω–µ.

---

## ‚úÖ –ò—Ç–æ–≥

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** ComfyUI Watchdog (–†–µ—à–µ–Ω–∏–µ 1)

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- ‚úÖ –ù–∞–¥–µ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–æ—Å—Ç—É–ø–∞ –∫ –æ–∫–Ω—É
- ‚úÖ –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –õ–µ–≥–∫–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è

**–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ "–±—É–¥–∏—Ç" ComfyUI –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥!** üöÄ
