# üîß –£–õ–£–ß–®–ï–ù–ò–Ø –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø

**–î–∞—Ç–∞:** 25 —è–Ω–≤–∞—Ä—è 2026  
**–¶–µ–ª—å:** –£–ª—É—á—à–∏—Ç—å –≤–∏–¥–∏–º–æ—Å—Ç—å —Ä–∞–±–æ—Ç—ã Window Waker –∏ Worker proactive wakeup –≤ –ª–æ–≥–∞—Ö

---

## ‚úÖ –í–ù–ï–°–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. ComfyUI Window Waker (`comfyui_window_waker.py`)

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:

1. **–£—Å–ø–µ—à–Ω—ã–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è:**
   - **–ë—ã–ª–æ:** `logger.debug(f"ComfyUI window woken successfully...")`
   - **–°—Ç–∞–ª–æ:** `logger.info(f"ComfyUI window woken successfully (HWND: {hwnd}, total: {self.stats['successful_wakes']})")`
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥–æ–µ —É—Å–ø–µ—à–Ω–æ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ –≤–∏–¥–Ω–æ –≤ –ª–æ–≥–∞—Ö

2. **–û–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ:**
   - **–ë—ã–ª–æ:** `logger.debug(f"ComfyUI window not found...")` (–∫–∞–∂–¥—ã–π —Ä–∞–∑)
   - **–°—Ç–∞–ª–æ:** –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥—ã–µ 10 –ø–æ–ø—ã—Ç–æ–∫
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–µ–Ω—å—à–µ —à—É–º–∞ –≤ –ª–æ–≥–∞—Ö, –Ω–æ –≤–∞–∂–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è

**–ü—Ä–∏–º–µ—Ä –Ω–æ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞:**
```
2026-01-25 00:45:00 - INFO - ComfyUI window woken successfully (HWND: 10486688, total: 1)
2026-01-25 00:45:15 - INFO - ComfyUI window woken successfully (HWND: 10486688, total: 2)
2026-01-25 00:45:30 - INFO - ComfyUI window woken successfully (HWND: 10486688, total: 3)
```

---

### 2. Worker Proactive Wakeup (`worker/processors/image_editor.py`)

#### –ò–∑–º–µ–Ω–µ–Ω–∏—è:

1. **Proactive wakeup –∑–∞–ø—Ä–æ—Å:**
   - **–ë—ã–ª–æ:** `logger.debug(f"Proactive ComfyUI wakeup at attempt {attempt}...")`
   - **–°—Ç–∞–ª–æ:** `logger.info(f"Proactive ComfyUI wakeup at attempt {attempt} to prevent sleeping...")`
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π proactive wakeup –≤–∏–¥–µ–Ω –≤ –ª–æ–≥–∞—Ö

2. **–£—Å–ø–µ—à–Ω—ã–π wakeup:**
   - **–î–æ–±–∞–≤–ª–µ–Ω–æ:** `logger.debug(f"Proactive wakeup successful at attempt {attempt}")`
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

3. **–ù–µ—É–¥–∞—á–Ω—ã–π wakeup:**
   - **–ë—ã–ª–æ:** `logger.debug(f"Proactive wakeup failed...")`
   - **–°—Ç–∞–ª–æ:** `logger.warning(f"Proactive wakeup failed at attempt {attempt} (non-critical): {wakeup_error}")`
   - **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ù–µ—É–¥–∞—á–∏ —Ç–µ–ø–µ—Ä—å –≤–∏–¥–Ω—ã –∫–∞–∫ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –Ω–æ–≤–æ–≥–æ –≤—ã–≤–æ–¥–∞:**
```
2026-01-25 00:52:00 - INFO - Waiting for job 222... (attempt 40/3600, 10.0s elapsed)
2026-01-25 00:52:00 - INFO - Proactive ComfyUI wakeup at attempt 40 to prevent sleeping...
2026-01-25 00:52:00 - DEBUG - Proactive wakeup successful at attempt 40
2026-01-25 00:52:02 - INFO - Waiting for job 222... (attempt 50/3600, 12.5s elapsed)
...
2026-01-25 00:52:10 - INFO - Proactive ComfyUI wakeup at attempt 80 to prevent sleeping...
```

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –î–û –ò –ü–û–°–õ–ï

### Window Waker:

| –°–æ–±—ã—Ç–∏–µ | –î–æ | –ü–æ—Å–ª–µ |
|---------|-----|-------|
| –£—Å–ø–µ—à–Ω–æ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ | DEBUG (–Ω–µ –≤–∏–¥–Ω–æ) | INFO (–≤–∏–¥–Ω–æ) |
| –û–∫–Ω–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ | DEBUG (–∫–∞–∂–¥—ã–π —Ä–∞–∑) | INFO (–∫–∞–∂–¥—ã–µ 10 –ø–æ–ø—ã—Ç–æ–∫) |
| –ù–µ—É–¥–∞—á–Ω–æ–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏–µ | WARNING (–≤–∏–¥–Ω–æ) | WARNING (–≤–∏–¥–Ω–æ) ‚úÖ |

### Worker Proactive Wakeup:

| –°–æ–±—ã—Ç–∏–µ | –î–æ | –ü–æ—Å–ª–µ |
|---------|-----|-------|
| Proactive wakeup –∑–∞–ø—Ä–æ—Å | DEBUG (–Ω–µ –≤–∏–¥–Ω–æ) | INFO (–≤–∏–¥–Ω–æ) |
| –£—Å–ø–µ—à–Ω—ã–π wakeup | –ù–µ—Ç | DEBUG (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏) |
| –ù–µ—É–¥–∞—á–Ω—ã–π wakeup | DEBUG (–Ω–µ –≤–∏–¥–Ω–æ) | WARNING (–≤–∏–¥–Ω–æ) |

---

## üéØ –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤:

1. **Window Waker –ª–æ–≥–∏:**
   - –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å —É—Å–ø–µ—à–Ω—ã–µ –ø—Ä–æ–±—É–∂–¥–µ–Ω–∏—è –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥
   - –§–æ—Ä–º–∞—Ç: `ComfyUI window woken successfully (HWND: X, total: Y)`

2. **Worker –ª–æ–≥–∏:**
   - –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å proactive wakeup –∫–∞–∂–¥—ã–µ 40 –ø–æ–ø—ã—Ç–æ–∫ (10 —Å–µ–∫—É–Ω–¥) –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
   - –§–æ—Ä–º–∞—Ç: `Proactive ComfyUI wakeup at attempt X to prevent sleeping...`

3. **–í–∏–¥–∏–º–æ—Å—Ç—å:**
   - –í—Å–µ –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è —Ç–µ–ø–µ—Ä—å –Ω–∞ —É—Ä–æ–≤–Ω–µ INFO/WARNING
   - –õ–µ–≥–∫–æ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## üìù –ü–†–û–í–ï–†–ö–ê

### –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

1. **Window Waker:**
   ```bash
   tail -f logs/comfyui/waker.log
   ```
   - –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å –∑–∞–ø–∏—Å–∏ –∫–∞–∂–¥—ã–µ 15 —Å–µ–∫—É–Ω–¥

2. **Worker:**
   ```bash
   tail -f logs/worker/runtime.log
   ```
   - –î–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å "Proactive ComfyUI wakeup" –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥ –≤–æ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏

---

## ‚úÖ –°–¢–ê–¢–£–°

**–ò–∑–º–µ–Ω–µ–Ω–∏—è –≤–Ω–µ—Å–µ–Ω—ã –∏ –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã.**

**–°–ª–µ–¥—É—é—â–∏–π —à–∞–≥:** –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π.

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
