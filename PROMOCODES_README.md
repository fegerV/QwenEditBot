# –ü—Ä–æ–º–æ–∫–æ–¥—ã - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ

## –û–±–∑–æ—Ä

–°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å –∏ –≤—ã–¥–∞–≤–∞—Ç—å –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –±–µ—Å—Å—Ä–æ—á–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã –¥–ª—è –∑–∞—á–∏—Å–ª–µ–Ω–∏—è –±–∞–ª–ª–æ–≤ –Ω–∞ —Å—á–µ—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–û–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã**: –ö–∞–∂–¥—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑
- **–ë–µ—Å—Å—Ä–æ—á–Ω—ã–µ**: –ü—Ä–æ–º–æ–∫–æ–¥—ã –Ω–µ –∏–º–µ—é—Ç —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
- **–ù–æ–º–∏–Ω–∞–ª—ã**: 100, 200, 300, 400, 500, 1000, 2000, 3000, 5000 –±–∞–ª–ª–æ–≤
- **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª**: –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª

## API –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã

### 1. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞

**POST** `/api/promocodes/generate`

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `amount` (int, required): –ù–æ–º–∏–Ω–∞–ª –ø—Ä–æ–º–æ–∫–æ–¥–∞ –≤ –±–∞–ª–ª–∞—Ö (–¥–æ–ø—É—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è: 100, 200, 300, 400, 500, 1000, 2000, 3000, 5000)
- `custom_code` (str, optional): –ö–∞—Å—Ç–æ–º–Ω—ã–π –∫–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```bash
curl -X POST "http://localhost:8000/api/promocodes/generate?amount=500"
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
{
  "id": 1,
  "code": "ABC12345",
  "amount": 500,
  "is_used": false,
  "used_at": null,
  "used_by_user_id": null,
  "created_at": "2024-01-21T10:00:00"
}
```

### 2. –ú–∞—Å—Å–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤

**POST** `/api/promocodes/batch-generate`

–¢–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞:
```json
{
  "amounts": [100, 200, 300, 500, 1000]
}
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞:
```json
{
  "success": true,
  "count": 5,
  "file_path": "/home/engine/project/data/promocodes_20240121_100000.txt",
  "promocodes": [
    {
      "code": "XYZ98765",
      "amount": 100,
      "created_at": "2024-01-21T10:00:00"
    },
    ...
  ]
}
```

### 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞

**POST** `/api/promocodes/use`

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `user_id` (int, required): ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `code` (str, required): –ö–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```bash
curl -X POST "http://localhost:8000/api/promocodes/use?user_id=123" \
  -H "Content-Type: application/json" \
  -d '{"code": "ABC12345"}'
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (—É—Å–ø–µ—Ö):
```json
{
  "success": true,
  "message": "–ü—Ä–æ–º–æ–∫–æ–¥ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! +500 –±–∞–ª–ª–æ–≤",
  "amount": 500,
  "new_balance": 560.0
}
```

–ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ (–æ—à–∏–±–∫–∞):
```json
{
  "success": false,
  "message": "–ü—Ä–æ–º–æ–∫–æ–¥ –Ω–µ –Ω–∞–π–¥–µ–Ω"
}
```

### 4. –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤

**GET** `/api/promocodes/list`

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `skip` (int, optional): –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å N –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0)
- `limit` (int, optional): –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 100)

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```bash
curl "http://localhost:8000/api/promocodes/list?limit=10"
```

### 5. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–º–æ–∫–æ–¥–µ

**GET** `/api/promocodes/{code}`

–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:
```bash
curl "http://localhost:8000/api/promocodes/ABC12345"
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –±–æ—Ç–µ

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

1. –û—Ç–∫—Ä–æ–π—Ç–µ –º–µ–Ω—é –ø—Ä–æ—Ñ–∏–ª—è (–∫–Ω–æ–ø–∫–∞ "üí∞ –ë–∞–ª–∞–Ω—Å")
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "üéÅ –ü—Ä–æ–º–æ–∫–æ–¥"
3. –í–≤–µ–¥–∏—Ç–µ –∫–æ–¥ –ø—Ä–æ–º–æ–∫–æ–¥–∞
4. –ï—Å–ª–∏ –∫–æ–¥ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–π, –±–∞–ª–ª—ã –±—É–¥—É—Ç –∑–∞—á–∏—Å–ª–µ–Ω—ã –Ω–∞ –±–∞–ª–∞–Ω—Å

### –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤

| –ù–æ–º–∏–Ω–∞–ª | –ö–æ–¥ (–ø—Ä–∏–º–µ—Ä) | –ë–∞–ª–ª—ã |
|---------|--------------|-------|
| 100 | A1B2C3D4     | 100   |
| 200 | E5F6G7H8     | 200   |
| 500 | I9J0K1L2     | 500   |
| 1000 | M3N4O5P6    | 1000  |
| 5000 | Q7R8S9T0    | 5000  |

## –°–∫—Ä–∏–ø—Ç—ã –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤

### –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ–¥–∏–Ω–æ—á–Ω–æ–≥–æ –ø—Ä–æ–º–æ–∫–æ–¥–∞

```bash
python scripts/generate_promocodes.py --single 500
```

–° –∫–∞—Å—Ç–æ–º–Ω—ã–º –∫–æ–¥–æ–º:
```bash
python scripts/generate_promocodes.py --single 500 --custom-code MYCODE
```

### –ú–∞—Å—Å–æ–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤

```bash
python scripts/generate_promocodes.py --batch 100 200 300 500 1000 2000
```

### –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º

```bash
python scripts/generate_promocodes.py
```

## –§–∞–π–ª —Å –ø—Ä–æ–º–æ–∫–æ–¥–∞–º–∏

–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—Ä–æ–º–æ–∫–æ–¥—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ —Ñ–∞–π–ª `data/promocodes_{timestamp}.txt`

–§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–∞:
```
# Generated Promocodes - 2024-01-21 10:00:00
# Total: 5 promocodes
# Format: CODE - AMOUNT (points)

ABC12345 - 100
DEF67890 - 200
GHI13579 - 300
JKL24680 - 500
MNO35791 - 1000
```

## –°—Ç–∞—Ç—É—Å –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤

–ü—Ä–æ–º–æ–∫–æ–¥—ã –º–æ–≥—É—Ç –±—ã—Ç—å –≤ –¥–≤—É—Ö —Å–æ—Å—Ç–æ—è–Ω–∏—è—Ö:
- **–î–æ—Å—Ç—É–ø–µ–Ω** (`is_used: false`) - –ü—Ä–æ–º–æ–∫–æ–¥ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å
- **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω** (`is_used: true`) - –ü—Ä–æ–º–æ–∫–æ–¥ —É–∂–µ –±—ã–ª –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –ö–∞–∂–¥—ã–π –ø—Ä–æ–º–æ–∫–æ–¥ —É–Ω–∏–∫–∞–ª–µ–Ω (8 —Å–∏–º–≤–æ–ª–æ–≤, –∑–∞–≥–ª–∞–≤–Ω—ã–µ –±—É–∫–≤—ã + —Ü–∏—Ñ—Ä—ã)
- –ü—Ä–æ–º–æ–∫–æ–¥—ã –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–µ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ –ø–ª–∞—Ç–µ–∂–µ–π
- –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫–æ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –∫–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø—Ä–æ–º–æ–∫–æ–¥

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –ø–ª–∞—Ç–µ–∂–µ–π

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–º–æ–∫–æ–¥–∞ —Å–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `payments`:
- `payment_type`: "promocode"
- `payment_method`: "promocode"
- `amount`: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –±–∞–ª–ª–æ–≤ (–≤ –∫–æ–ø–µ–π–∫–∞—Ö –¥–ª—è —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —Å YuKassa)
- `status`: "succeeded"

–ü—Ä–æ–º–æ–∫–æ–¥—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –≤ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∫–∞–∫ "üéÅ –ü—Ä–æ–º–æ–∫–æ–¥".

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–ª–µ–¥—É—é—â–∏–π –ø—Ä–æ–º–æ–∫–æ–¥:
```bash
python scripts/generate_promocodes.py --single 100 --custom-code TESTCODE
```

–ó–∞—Ç–µ–º –≤ –±–æ—Ç–µ –≤–≤–µ–¥–∏—Ç–µ –∫–æ–¥ `TESTCODE`.

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ú–∞—Ä–∫–µ—Ç–∏–Ω–≥: –ê–∫—Ü–∏—è –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```bash
# –°–æ–∑–¥–∞—Ç—å 100 –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –ø–æ 100 –±–∞–ª–ª–æ–≤ –¥–ª—è —Ä–∞–∑–¥–∞—á–∏ –Ω–æ–≤—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
python scripts/generate_promocodes.py --batch $(printf '100 %.0s' {1..100})
```

### –†–æ–∑—ã–≥—Ä—ã—à: –ü—Ä–∏–∑ 5000 –±–∞–ª–ª–æ–≤
```bash
# –°–æ–∑–¥–∞—Ç—å –æ–¥–∏–Ω –ø—Ä–æ–º–æ–∫–æ–¥ –Ω–∞ 5000 –±–∞–ª–ª–æ–≤
python scripts/generate_promocodes.py --single 5000 --custom-code WINNER5000
```

### –ö–∞–º–ø–∞–Ω–∏–∏ –¥–ª—è –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
```bash
# –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ–º–æ–∫–æ–¥—ã —Ä–∞–∑–Ω–æ–≥–æ –Ω–æ–º–∏–Ω–∞–ª–∞ –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π –ø–∞—Ä—Ç–Ω–µ—Ä–æ–≤
python scripts/generate_promocodes.py --batch 1000 2000 3000 5000
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ü—Ä–æ–º–æ–∫–æ–¥—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö –≤ —Ç–∞–±–ª–∏—Ü–µ `promocodes`
- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–æ–º–æ–∫–æ–¥—ã –æ—Å—Ç–∞—é—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–µ
- –ü—Ä–æ–º–æ–∫–æ–¥—ã –Ω–µ–ª—å–∑—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ
- –ù–æ–º–∏–Ω–∞–ª—ã –ø—Ä–æ–º–æ–∫–æ–¥–æ–≤ –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –≤ —Å–∏—Å—Ç–µ–º–µ
